<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (version 1.7.0_45) on Thu May 28 20:09:46 CDT 2015 -->
<title>RaftKVDatabase (Java Class Library API)</title>
<meta name="date" content="2015-05-28">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
</head>
<body>
<script type="text/javascript"><!--
    if (location.href.indexOf('is-external=true') == -1) {
        parent.document.title="RaftKVDatabase (Java Class Library API)";
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar_top">
<!--   -->
</a><a href="#skip-navbar_top" title="Skip navigation links"></a><a name="navbar_top_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/RaftKVDatabase.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev Class</li>
<li><a href="../../../../org/jsimpledb/kv/raft/RaftKVTransaction.html" title="class in org.jsimpledb.kv.raft"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?org/jsimpledb/kv/raft/RaftKVDatabase.html" target="_top">Frames</a></li>
<li><a href="RaftKVDatabase.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">org.jsimpledb.kv.raft</div>
<h2 title="Class RaftKVDatabase" class="title">Class RaftKVDatabase</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li><a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">java.lang.Object</a></li>
<li>
<ul class="inheritance">
<li>org.jsimpledb.kv.raft.RaftKVDatabase</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<dl>
<dt>All Implemented Interfaces:</dt>
<dd><a href="../../../../org/jsimpledb/kv/KVDatabase.html" title="interface in org.jsimpledb.kv">KVDatabase</a></dd>
</dl>
<hr>
<br>
<pre>public class <a href="../../../../src-html/org/jsimpledb/kv/raft/RaftKVDatabase.html#line.206">RaftKVDatabase</a>
extends <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a>
implements <a href="../../../../org/jsimpledb/kv/KVDatabase.html" title="interface in org.jsimpledb.kv">KVDatabase</a></pre>
<div class="block">A distributed <a href="../../../../org/jsimpledb/kv/KVDatabase.html" title="interface in org.jsimpledb.kv"><code>KVDatabase</code></a> based on the Raft consensus algorithm.

 <p>
 Raft defines a distributed consensus algorithm for maintaining a shared state machine.
 Each Raft node maintains a complete copy of the state machine. Cluster nodes elect a
 leader who manages updates to the state machine and provides for consistent readds.
 As long as as a node is part of a majority, the state machine is fully operational.

 <p>
 <a href="../../../../org/jsimpledb/kv/raft/RaftKVDatabase.html" title="class in org.jsimpledb.kv.raft"><code>RaftKVDatabase</code></a> turns
 this into a transactional key/value database with linearizable ACID semantics:
  <ul>
  <li>The Raft state machine is the key/value store data.</li>
  <li>Unapplied log entries are stored on disk as serialized <a href="../../../../org/jsimpledb/kv/mvcc/Writes.html" title="class in org.jsimpledb.kv.mvcc"><code>Writes</code></a>, and also cached in memory.</li>
  <li>On leaders only, the <a href="../../../../org/jsimpledb/kv/mvcc/Writes.html" title="class in org.jsimpledb.kv.mvcc"><code>Writes</code></a> associated with some number of the most recently applied log entries
      are cached in memory for time <i>T<sub>max</sub></i> since creation, where <i>T<sub>max</sub></i> is the
      maximum supported transaction duration (see below for how these cached <a href="../../../../org/jsimpledb/kv/mvcc/Writes.html" title="class in org.jsimpledb.kv.mvcc"><code>Writes</code></a> are used).
      This caching is subject to <i>M<sub>max</sub></i>, which limits the total memory used by memory-cached
      <a href="../../../../org/jsimpledb/kv/mvcc/Writes.html" title="class in org.jsimpledb.kv.mvcc"><code>Writes</code></a>; if reached, these cached <a href="../../../../org/jsimpledb/kv/mvcc/Writes.html" title="class in org.jsimpledb.kv.mvcc"><code>Writes</code></a> are discarded early.</li>
  <li>Concurrent transactions are supported through a simple optimistic locking MVCC scheme (same as used by
      <a href="../../../../org/jsimpledb/kv/mvcc/SnapshotKVDatabase.html" title="class in org.jsimpledb.kv.mvcc"><code>SnapshotKVDatabase</code></a>):
      <ul>
      <li>Transactions execute locally until commit time, using a <a href="../../../../org/jsimpledb/kv/mvcc/MutableView.html" title="class in org.jsimpledb.kv.mvcc"><code>MutableView</code></a> to collect mutations.
          The <a href="../../../../org/jsimpledb/kv/mvcc/MutableView.html" title="class in org.jsimpledb.kv.mvcc"><code>MutableView</code></a> is based on the local node's most recent log entry (whether committed or not);
          this is called the <i>base term and index</i> for the transaction.</li>
      <li>On commit, the transaction's <a href="../../../../org/jsimpledb/kv/mvcc/Reads.html" title="class in org.jsimpledb.kv.mvcc"><code>Reads</code></a>, <a href="../../../../org/jsimpledb/kv/mvcc/Writes.html" title="class in org.jsimpledb.kv.mvcc"><code>Writes</code></a>, and base index and term are
          <a href="../../../../org/jsimpledb/kv/raft/msg/CommitRequest.html" title="class in org.jsimpledb.kv.raft.msg">sent</a> to the leader.</li>
      <li>The leader confirms that the log entry corresponding to the transaction's base index and term either:
          <ul>
          <li>Is still present in its own log and not yet applied to the state machine (in which case the
              <a href="../../../../org/jsimpledb/kv/mvcc/Writes.html" title="class in org.jsimpledb.kv.mvcc"><code>Writes</code></a> are available with the log entry); or</li>
          <li>Corresponds to an already applied log entry whose <a href="../../../../org/jsimpledb/kv/mvcc/Writes.html" title="class in org.jsimpledb.kv.mvcc"><code>Writes</code></a> are still cached in memory.</li>
          </ul>
          If this is not the case, then the transaction's base log entry is too old (older than <i>T<sub>max</sub></i>,
          or was committed early due to memory pressure), and so the transaction is rejected with a
          <a href="../../../../org/jsimpledb/kv/RetryTransactionException.html" title="class in org.jsimpledb.kv"><code>RetryTransactionException</code></a>. Otherwise, the <a href="../../../../org/jsimpledb/kv/mvcc/Writes.html" title="class in org.jsimpledb.kv.mvcc"><code>Writes</code></a> associated with all log entries
          after the transaction's base log entry are available.
      <li>The leader confirms that the <a href="../../../../org/jsimpledb/kv/mvcc/Writes.html" title="class in org.jsimpledb.kv.mvcc"><code>Writes</code></a> associated with log entries created after the transaction's
          base log entry do not create linearizability violations when <a href="../../../../org/jsimpledb/kv/mvcc/Reads.html#isConflict(org.jsimpledb.kv.mvcc.Mutations)">compared against</a>
          the transaction's <a href="../../../../org/jsimpledb/kv/mvcc/Reads.html" title="class in org.jsimpledb.kv.mvcc"><code>Reads</code></a>. If so, the transaction is rejected with a retry.</li>
      <li>The leader adds a new log entry consisting of the transaction's <a href="../../../../org/jsimpledb/kv/mvcc/Writes.html" title="class in org.jsimpledb.kv.mvcc"><code>Writes</code></a> to its log.
          The associated term and index become the transaction's <i>commit term and index</i>; the leader
          then <a href="../../../../org/jsimpledb/kv/raft/msg/CommitResponse.html" title="class in org.jsimpledb.kv.raft.msg">replies</a> to the follower with this information.</li>
      <li>When the follower sees a log entry appear in its log matching the transaction's commit term and index, and
          that log entry has been committed (in the Raft sense), the transaction is also committed.</li>
      <li>As an optimization, when the leader sends a log entry to the same follower who committed the corresponding
          transaction in the first place, only the transaction ID is sent, because the follower already has the data.</li>
      </ul>
  </li>
  <li>For transactions occurring on a leader, the logic is the same except of course no network communication occurs.</li>
  <li>For read-only transactions, the leader does not create a new log entry; instead, the transaction's commit
      term and index are set to the term and index of the last entry in the leader's log. The leader also calculates its
      current "leader lease timeout", which is the earliest time at which it is possible for another leader to be elected.
      This is calculated as the time in the past at which the leader sent <a href="../../../../org/jsimpledb/kv/raft/msg/AppendRequest.html" title="class in org.jsimpledb.kv.raft.msg"><code>AppendRequest</code></a>'s to a majority of followers
      who have since responded, plus the <a href="../../../../org/jsimpledb/kv/raft/RaftKVDatabase.html#setMinElectionTimeout(int)">minimum election timeout</a>, minus a small adjustment
      for possible clock drift (this assumes all nodes have the same minimum election timeout configured). If the current
      time is prior to the leader lease timeout, the transaction may be committed immediately; otherwise, the current time
      is returned to the follower as minimum required leader lease timeout before the transaction may be committed.</li>
  <li>Included with each <a href="../../../../org/jsimpledb/kv/raft/msg/AppendRequest.html" title="class in org.jsimpledb.kv.raft.msg"><code>AppendRequest</code></a> is the leader's current timestamp and lease timeout, so followers can commit
      any waiting read-only transactions. Leaders keep track of which followers are waiting on which leader lease
      timeout values, and when the leader lease timeout advances to allow a follower to commit a transaction, the follower
      is notified with an immediate <a href="../../../../org/jsimpledb/kv/raft/msg/AppendRequest.html" title="class in org.jsimpledb.kv.raft.msg"><code>AppendRequest</code></a> update.</li>
  <li>A weaker consistency guarantee for read-only transactions (serializable but not linearizable) is also possible; see
      <a href="../../../../org/jsimpledb/kv/raft/RaftKVTransaction.html#setReadOnlySnapshot(boolean)"><code>RaftKVTransaction.setReadOnlySnapshot()</code></a>.</li>
  </ul>

 <p><b>Limitations</b></p>

 <ul>
  <li>A transaction's mutations must fit in memory.</li>
  <li>An <a href="../../../../org/jsimpledb/kv/mvcc/AtomicKVStore.html" title="interface in org.jsimpledb.kv.mvcc"><code>AtomicKVStore</code></a> is required to store local persistent state;
      if none is configured, a <a href="../../../../org/jsimpledb/kv/leveldb/LevelDBKVStore.html" title="class in org.jsimpledb.kv.leveldb"><code>LevelDBKVStore</code></a> is used.</li>
  <li>All nodes must be configured with the same <a href="../../../../org/jsimpledb/kv/raft/RaftKVDatabase.html#setMinElectionTimeout(int)">minimum election timeout</a>.</li>
  <li>Due to the optimistic locking approach used, this implementation will perform poorly when there is a high
      rate of conflicting transactions; the result will be many transaction retries.</li>
  <li>Performance will suffer when the amount of data associated with a typical transaction cannot be delivered
      quickly and reliably over the network.</li>
 </ul>

 <p><b>Cluster Configuration</b></p>

 <p>
 Instances support dynamic cluster configuration changes at runtime. Initially, all nodes are in an <i>unconfigured</i>
 state, where nothing has been added to the Raft log yet and no cluster is defined. Unconfigured nodes are passive: they
 stay in follower mode (i.e., they will not start elections), and they disallow local transactions that make any changes
 (other than as described below to initialize a new cluster).

 <p>
 A node is configured if and only if it has a <i>configuration</i>. A cluster configuration consists of the identites of
 the nodes in the cluster, and their corresponding network addresses. Once a node <i>configured</i>, a separate issue
 is whether a node is <i>included</i> in its own configuration. A node that is not included in its own configuration
 does not count its own vote for elections and log commits, but otherwise functions normally in the cluster.

 <p>
 An unconfigured node becomes configured when either:
 <ul>
  <li>An <a href="../../../../org/jsimpledb/kv/raft/msg/AppendRequest.html" title="class in org.jsimpledb.kv.raft.msg"><code>AppendRequest</code></a> is received from a leader of some existing cluster, in which case the node
      joins the cluster and applies the received cluster configuration; or</li>
  <li><a href="../../../../org/jsimpledb/kv/raft/RaftKVTransaction.html#configChange"><code>RaftKVTransaction.configChange()</code></a> is invoked and committed within
      a local transaction, which creates a new cluster and configures it to contain the local node</li>
 </ul>

 <p>
 On the first commit, newly created clusters are assigned a random 32-bit cluster ID. This ID is included in all
 messages sent over the network, and adopted by unconfigured nodes that join the cluster. Configured nodes will discard
 incoming messages containing a different cluster ID. This prevents data corruption that can occur if nodes from two
 different clusters are inadvertently "mixed" together.

 <p>
 Once a node joins a cluster (identified by cluster ID), it cannot be reassigned to a different cluster without first
 returning it to the unconfigured state; to do that, it must be shut it down and its persistent state directory deleted.</div>
<dl><dt><span class="strong">See Also:</span></dt><dd><a href="https://raftconsensus.github.io/">The Raft Consensus Algorithm</a></dd></dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- =========== FIELD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_summary">
<!--   -->
</a>
<h3>Field Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Field Summary table, listing fields, and an explanation">
<caption><span>Fields</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Field and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static int</code></td>
<td class="colLast"><code><strong><a href="../../../../org/jsimpledb/kv/raft/RaftKVDatabase.html#DEFAULT_COMMIT_TIMEOUT">DEFAULT_COMMIT_TIMEOUT</a></strong></code>
<div class="block">Default transaction commit timeout (5000).</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static int</code></td>
<td class="colLast"><code><strong><a href="../../../../org/jsimpledb/kv/raft/RaftKVDatabase.html#DEFAULT_HEARTBEAT_TIMEOUT">DEFAULT_HEARTBEAT_TIMEOUT</a></strong></code>
<div class="block">Default heartbeat timeout (200ms).</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static long</code></td>
<td class="colLast"><code><strong><a href="../../../../org/jsimpledb/kv/raft/RaftKVDatabase.html#DEFAULT_MAX_APPLIED_LOG_MEMORY">DEFAULT_MAX_APPLIED_LOG_MEMORY</a></strong></code>
<div class="block">Default maximum supported applied log entry memory usage (104857600L bytes).</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static int</code></td>
<td class="colLast"><code><strong><a href="../../../../org/jsimpledb/kv/raft/RaftKVDatabase.html#DEFAULT_MAX_ELECTION_TIMEOUT">DEFAULT_MAX_ELECTION_TIMEOUT</a></strong></code>
<div class="block">Default maximum election timeout (1000ms).</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>static int</code></td>
<td class="colLast"><code><strong><a href="../../../../org/jsimpledb/kv/raft/RaftKVDatabase.html#DEFAULT_MAX_TRANSACTION_DURATION">DEFAULT_MAX_TRANSACTION_DURATION</a></strong></code>
<div class="block">Default maximum supported outstanding transaction duration (10000ms).</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>static int</code></td>
<td class="colLast"><code><strong><a href="../../../../org/jsimpledb/kv/raft/RaftKVDatabase.html#DEFAULT_MIN_ELECTION_TIMEOUT">DEFAULT_MIN_ELECTION_TIMEOUT</a></strong></code>
<div class="block">Default minimum election timeout (750ms).</div>
</td>
</tr>
</table>
</li>
</ul>
<!-- ======== CONSTRUCTOR SUMMARY ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_summary">
<!--   -->
</a>
<h3>Constructor Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Constructor Summary table, listing constructors, and an explanation">
<caption><span>Constructors</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colOne" scope="col">Constructor and Description</th>
</tr>
<tr class="altColor">
<td class="colOne"><code><strong><a href="../../../../org/jsimpledb/kv/raft/RaftKVDatabase.html#RaftKVDatabase()">RaftKVDatabase</a></strong>()</code>&nbsp;</td>
</tr>
</table>
</li>
</ul>
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method_summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="overviewSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span>Methods</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr class="altColor">
<td class="colFirst"><code><a href="../../../../org/jsimpledb/kv/raft/RaftKVTransaction.html" title="class in org.jsimpledb.kv.raft">RaftKVTransaction</a></code></td>
<td class="colLast"><code><strong><a href="../../../../org/jsimpledb/kv/raft/RaftKVDatabase.html#createTransaction()">createTransaction</a></strong>()</code>
<div class="block">Create a new transaction.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>int</code></td>
<td class="colLast"><code><strong><a href="../../../../org/jsimpledb/kv/raft/RaftKVDatabase.html#getClusterId()">getClusterId</a></strong>()</code>
<div class="block">Retrieve the unique 32-bit ID for this node's cluster.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code><a href="https://docs.oracle.com/javase/7/docs/api/java/util/Map.html?is-external=true" title="class or interface in java.util">Map</a>&lt;<a href="https://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>,<a href="https://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&gt;</code></td>
<td class="colLast"><code><strong><a href="../../../../org/jsimpledb/kv/raft/RaftKVDatabase.html#getCurrentConfig()">getCurrentConfig</a></strong>()</code>
<div class="block">Retrieve the current cluster configuration as understood by this node.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code><a href="https://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a></code></td>
<td class="colLast"><code><strong><a href="../../../../org/jsimpledb/kv/raft/RaftKVDatabase.html#getIdentity()">getIdentity</a></strong>()</code>
<div class="block">Get this node's Raft identity.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../org/jsimpledb/kv/raft/RaftKVDatabase.html#isClusterMember()">isClusterMember</a></strong>()</code>
<div class="block">Determine whether this node thinks that it is part of the cluster, as currently configured on this node.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../org/jsimpledb/kv/raft/RaftKVDatabase.html#isClusterMember(java.lang.String)">isClusterMember</a></strong>(<a href="https://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;node)</code>
<div class="block">Determine whether this node thinks that the specified node is part of the cluster, as currently configured on this node.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><strong><a href="../../../../org/jsimpledb/kv/raft/RaftKVDatabase.html#isConfigured()">isConfigured</a></strong>()</code>
<div class="block">Determine whether this instance is configured.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../org/jsimpledb/kv/raft/RaftKVDatabase.html#setCommitTimeout(int)">setCommitTimeout</a></strong>(int&nbsp;timeout)</code>
<div class="block">Configure the default transaction commit timeout.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../org/jsimpledb/kv/raft/RaftKVDatabase.html#setHeartbeatTimeout(int)">setHeartbeatTimeout</a></strong>(int&nbsp;timeout)</code>
<div class="block">Configure the heartbeat timeout.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../org/jsimpledb/kv/raft/RaftKVDatabase.html#setIdentity(java.lang.String)">setIdentity</a></strong>(<a href="https://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;identity)</code>
<div class="block">Configure the Raft identity.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../org/jsimpledb/kv/raft/RaftKVDatabase.html#setKVStore(org.jsimpledb.kv.mvcc.AtomicKVStore)">setKVStore</a></strong>(<a href="../../../../org/jsimpledb/kv/mvcc/AtomicKVStore.html" title="interface in org.jsimpledb.kv.mvcc">AtomicKVStore</a>&nbsp;kvstore)</code>
<div class="block">Configure the <a href="../../../../org/jsimpledb/kv/mvcc/AtomicKVStore.html" title="interface in org.jsimpledb.kv.mvcc"><code>AtomicKVStore</code></a> in which local persistent state is stored.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../org/jsimpledb/kv/raft/RaftKVDatabase.html#setLogDirectory(java.io.File)">setLogDirectory</a></strong>(<a href="https://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io">File</a>&nbsp;directory)</code>
<div class="block">Configure the directory in which uncommitted log entries are stored.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../org/jsimpledb/kv/raft/RaftKVDatabase.html#setMaxAppliedLogMemory(long)">setMaxAppliedLogMemory</a></strong>(long&nbsp;memory)</code>
<div class="block">Configure the maximum allowed memory used for caching log entries that have already been applied to the state machine.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../org/jsimpledb/kv/raft/RaftKVDatabase.html#setMaxElectionTimeout(int)">setMaxElectionTimeout</a></strong>(int&nbsp;timeout)</code>
<div class="block">Configure the maximum election timeout.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../org/jsimpledb/kv/raft/RaftKVDatabase.html#setMaxTransactionDuration(int)">setMaxTransactionDuration</a></strong>(int&nbsp;duration)</code>
<div class="block">Configure the maximum supported duration for outstanding transactions.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../org/jsimpledb/kv/raft/RaftKVDatabase.html#setMinElectionTimeout(int)">setMinElectionTimeout</a></strong>(int&nbsp;timeout)</code>
<div class="block">Configure the minimum election timeout.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../org/jsimpledb/kv/raft/RaftKVDatabase.html#setNetwork(org.jsimpledb.kv.raft.net.Network)">setNetwork</a></strong>(<a href="../../../../org/jsimpledb/kv/raft/net/Network.html" title="interface in org.jsimpledb.kv.raft.net">Network</a>&nbsp;network)</code>
<div class="block">Configure the <a href="../../../../org/jsimpledb/kv/raft/net/Network.html" title="interface in org.jsimpledb.kv.raft.net"><code>Network</code></a> to use for inter-node communication.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../org/jsimpledb/kv/raft/RaftKVDatabase.html#start()">start</a></strong>()</code>
<div class="block">Start this instance.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><strong><a href="../../../../org/jsimpledb/kv/raft/RaftKVDatabase.html#stop()">stop</a></strong>()</code>
<div class="block">Stop this instance.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><code><a href="https://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a></code></td>
<td class="colLast"><code><strong><a href="../../../../org/jsimpledb/kv/raft/RaftKVDatabase.html#toString()">toString</a></strong>()</code>&nbsp;</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods_inherited_from_class_java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.<a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a></h3>
<code><a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#clone()" title="class or interface in java.lang">clone</a>, <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#equals(java.lang.Object)" title="class or interface in java.lang">equals</a>, <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#finalize()" title="class or interface in java.lang">finalize</a>, <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#getClass()" title="class or interface in java.lang">getClass</a>, <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#hashCode()" title="class or interface in java.lang">hashCode</a>, <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#notify()" title="class or interface in java.lang">notify</a>, <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#notifyAll()" title="class or interface in java.lang">notifyAll</a>, <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#wait()" title="class or interface in java.lang">wait</a>, <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#wait(long)" title="class or interface in java.lang">wait</a>, <a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#wait(long, int)" title="class or interface in java.lang">wait</a></code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ FIELD DETAIL =========== -->
<ul class="blockList">
<li class="blockList"><a name="field_detail">
<!--   -->
</a>
<h3>Field Detail</h3>
<a name="DEFAULT_MIN_ELECTION_TIMEOUT">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>DEFAULT_MIN_ELECTION_TIMEOUT</h4>
<pre>public static final&nbsp;int <a href="../../../../src-html/org/jsimpledb/kv/raft/RaftKVDatabase.html#line.213">DEFAULT_MIN_ELECTION_TIMEOUT</a></pre>
<div class="block">Default minimum election timeout (750ms).</div>
<dl><dt><span class="strong">See Also:</span></dt><dd><a href="../../../../org/jsimpledb/kv/raft/RaftKVDatabase.html#setMinElectionTimeout(int)"><code>setMinElectionTimeout(int)</code></a>, 
<a href="../../../../constant-values.html#org.jsimpledb.kv.raft.RaftKVDatabase.DEFAULT_MIN_ELECTION_TIMEOUT">Constant Field Values</a></dd></dl>
</li>
</ul>
<a name="DEFAULT_MAX_ELECTION_TIMEOUT">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>DEFAULT_MAX_ELECTION_TIMEOUT</h4>
<pre>public static final&nbsp;int <a href="../../../../src-html/org/jsimpledb/kv/raft/RaftKVDatabase.html#line.220">DEFAULT_MAX_ELECTION_TIMEOUT</a></pre>
<div class="block">Default maximum election timeout (1000ms).</div>
<dl><dt><span class="strong">See Also:</span></dt><dd><a href="../../../../org/jsimpledb/kv/raft/RaftKVDatabase.html#setMaxElectionTimeout(int)"><code>setMaxElectionTimeout(int)</code></a>, 
<a href="../../../../constant-values.html#org.jsimpledb.kv.raft.RaftKVDatabase.DEFAULT_MAX_ELECTION_TIMEOUT">Constant Field Values</a></dd></dl>
</li>
</ul>
<a name="DEFAULT_HEARTBEAT_TIMEOUT">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>DEFAULT_HEARTBEAT_TIMEOUT</h4>
<pre>public static final&nbsp;int <a href="../../../../src-html/org/jsimpledb/kv/raft/RaftKVDatabase.html#line.227">DEFAULT_HEARTBEAT_TIMEOUT</a></pre>
<div class="block">Default heartbeat timeout (200ms).</div>
<dl><dt><span class="strong">See Also:</span></dt><dd><a href="../../../../org/jsimpledb/kv/raft/RaftKVDatabase.html#setHeartbeatTimeout(int)"><code>setHeartbeatTimeout(int)</code></a>, 
<a href="../../../../constant-values.html#org.jsimpledb.kv.raft.RaftKVDatabase.DEFAULT_HEARTBEAT_TIMEOUT">Constant Field Values</a></dd></dl>
</li>
</ul>
<a name="DEFAULT_MAX_TRANSACTION_DURATION">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>DEFAULT_MAX_TRANSACTION_DURATION</h4>
<pre>public static final&nbsp;int <a href="../../../../src-html/org/jsimpledb/kv/raft/RaftKVDatabase.html#line.234">DEFAULT_MAX_TRANSACTION_DURATION</a></pre>
<div class="block">Default maximum supported outstanding transaction duration (10000ms).</div>
<dl><dt><span class="strong">See Also:</span></dt><dd><a href="../../../../org/jsimpledb/kv/raft/RaftKVDatabase.html#setMaxTransactionDuration(int)"><code>setMaxTransactionDuration(int)</code></a>, 
<a href="../../../../constant-values.html#org.jsimpledb.kv.raft.RaftKVDatabase.DEFAULT_MAX_TRANSACTION_DURATION">Constant Field Values</a></dd></dl>
</li>
</ul>
<a name="DEFAULT_MAX_APPLIED_LOG_MEMORY">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>DEFAULT_MAX_APPLIED_LOG_MEMORY</h4>
<pre>public static final&nbsp;long <a href="../../../../src-html/org/jsimpledb/kv/raft/RaftKVDatabase.html#line.241">DEFAULT_MAX_APPLIED_LOG_MEMORY</a></pre>
<div class="block">Default maximum supported applied log entry memory usage (104857600L bytes).</div>
<dl><dt><span class="strong">See Also:</span></dt><dd><a href="../../../../org/jsimpledb/kv/raft/RaftKVDatabase.html#setMaxAppliedLogMemory(long)"><code>setMaxAppliedLogMemory(long)</code></a>, 
<a href="../../../../constant-values.html#org.jsimpledb.kv.raft.RaftKVDatabase.DEFAULT_MAX_APPLIED_LOG_MEMORY">Constant Field Values</a></dd></dl>
</li>
</ul>
<a name="DEFAULT_COMMIT_TIMEOUT">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>DEFAULT_COMMIT_TIMEOUT</h4>
<pre>public static final&nbsp;int <a href="../../../../src-html/org/jsimpledb/kv/raft/RaftKVDatabase.html#line.249">DEFAULT_COMMIT_TIMEOUT</a></pre>
<div class="block">Default transaction commit timeout (5000).</div>
<dl><dt><span class="strong">See Also:</span></dt><dd><a href="../../../../org/jsimpledb/kv/raft/RaftKVDatabase.html#setCommitTimeout(int)"><code>setCommitTimeout(int)</code></a>, 
<a href="../../../../org/jsimpledb/kv/raft/RaftKVTransaction.html#setTimeout(long)"><code>RaftKVTransaction.setTimeout(long)</code></a>, 
<a href="../../../../constant-values.html#org.jsimpledb.kv.raft.RaftKVDatabase.DEFAULT_COMMIT_TIMEOUT">Constant Field Values</a></dd></dl>
</li>
</ul>
</li>
</ul>
<!-- ========= CONSTRUCTOR DETAIL ======== -->
<ul class="blockList">
<li class="blockList"><a name="constructor_detail">
<!--   -->
</a>
<h3>Constructor Detail</h3>
<a name="RaftKVDatabase()">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>RaftKVDatabase</h4>
<pre>public&nbsp;<a href="../../../../src-html/org/jsimpledb/kv/raft/RaftKVDatabase.html#line.206">RaftKVDatabase</a>()</pre>
</li>
</ul>
</li>
</ul>
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method_detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="setKVStore(org.jsimpledb.kv.mvcc.AtomicKVStore)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setKVStore</h4>
<pre>public&nbsp;void&nbsp;<a href="../../../../src-html/org/jsimpledb/kv/raft/RaftKVDatabase.html#line.327">setKVStore</a>(<a href="../../../../org/jsimpledb/kv/mvcc/AtomicKVStore.html" title="interface in org.jsimpledb.kv.mvcc">AtomicKVStore</a>&nbsp;kvstore)</pre>
<div class="block">Configure the <a href="../../../../org/jsimpledb/kv/mvcc/AtomicKVStore.html" title="interface in org.jsimpledb.kv.mvcc"><code>AtomicKVStore</code></a> in which local persistent state is stored.

 <p>
 If this property is left unconfigured, by default a <a href="../../../../org/jsimpledb/kv/leveldb/LevelDBKVStore.html" title="class in org.jsimpledb.kv.leveldb"><code>LevelDBKVStore</code></a> is created when
 <a href="../../../../org/jsimpledb/kv/raft/RaftKVDatabase.html#start()"><code>start()</code></a> is invoked and shutdown on <a href="../../../../org/jsimpledb/kv/raft/RaftKVDatabase.html#stop()"><code>stop()</code></a>.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>kvstore</code> - local persistent data store</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/javase/7/docs/api/java/lang/IllegalStateException.html?is-external=true" title="class or interface in java.lang">IllegalStateException</a></code> - if this instance is already started</dd></dl>
</li>
</ul>
<a name="setLogDirectory(java.io.File)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setLogDirectory</h4>
<pre>public&nbsp;void&nbsp;<a href="../../../../src-html/org/jsimpledb/kv/raft/RaftKVDatabase.html#line.341">setLogDirectory</a>(<a href="https://docs.oracle.com/javase/7/docs/api/java/io/File.html?is-external=true" title="class or interface in java.io">File</a>&nbsp;directory)</pre>
<div class="block">Configure the directory in which uncommitted log entries are stored.

 <p>
 Required property.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>directory</code> - log directory</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/javase/7/docs/api/java/lang/IllegalStateException.html?is-external=true" title="class or interface in java.lang">IllegalStateException</a></code> - if this instance is already started</dd></dl>
</li>
</ul>
<a name="setNetwork(org.jsimpledb.kv.raft.net.Network)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setNetwork</h4>
<pre>public&nbsp;void&nbsp;<a href="../../../../src-html/org/jsimpledb/kv/raft/RaftKVDatabase.html#line.355">setNetwork</a>(<a href="../../../../org/jsimpledb/kv/raft/net/Network.html" title="interface in org.jsimpledb.kv.raft.net">Network</a>&nbsp;network)</pre>
<div class="block">Configure the <a href="../../../../org/jsimpledb/kv/raft/net/Network.html" title="interface in org.jsimpledb.kv.raft.net"><code>Network</code></a> to use for inter-node communication.

 <p>
 By default, a <a href="../../../../org/jsimpledb/kv/raft/net/TCPNetwork.html" title="class in org.jsimpledb.kv.raft.net"><code>TCPNetwork</code></a> instance is used.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>network</code> - network implementation; must not be <a href="../../../../org/jsimpledb/kv/raft/net/Network.html#start(org.jsimpledb.kv.raft.net.Network.Handler)">started</a></dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/javase/7/docs/api/java/lang/IllegalStateException.html?is-external=true" title="class or interface in java.lang">IllegalStateException</a></code> - if this instance is already started</dd></dl>
</li>
</ul>
<a name="setIdentity(java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setIdentity</h4>
<pre>public&nbsp;void&nbsp;<a href="../../../../src-html/org/jsimpledb/kv/raft/RaftKVDatabase.html#line.369">setIdentity</a>(<a href="https://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;identity)</pre>
<div class="block">Configure the Raft identity.

 <p>
 Required property unless this is a single-node cluster.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>identity</code> - unique Raft identity of this node in its cluster</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/javase/7/docs/api/java/lang/IllegalStateException.html?is-external=true" title="class or interface in java.lang">IllegalStateException</a></code> - if this instance is already started</dd></dl>
</li>
</ul>
<a name="getIdentity()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getIdentity</h4>
<pre>public&nbsp;<a href="https://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;<a href="../../../../src-html/org/jsimpledb/kv/raft/RaftKVDatabase.html#line.379">getIdentity</a>()</pre>
<div class="block">Get this node's Raft identity.</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>the unique identity of this node in its cluster</dd></dl>
</li>
</ul>
<a name="setMinElectionTimeout(int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setMinElectionTimeout</h4>
<pre>public&nbsp;void&nbsp;<a href="../../../../src-html/org/jsimpledb/kv/raft/RaftKVDatabase.html#line.400">setMinElectionTimeout</a>(int&nbsp;timeout)</pre>
<div class="block">Configure the minimum election timeout.

 <p>
 This must be set to a value greater than the <a href="../../../../org/jsimpledb/kv/raft/RaftKVDatabase.html#setHeartbeatTimeout(int)">heartbeat timeout</a>.

 <p>
 Default is <a href="../../../../org/jsimpledb/kv/raft/RaftKVDatabase.html#DEFAULT_MIN_ELECTION_TIMEOUT"><code>DEFAULT_MIN_ELECTION_TIMEOUT</code></a>.

 <p>
 <b>Warning:</b> currently all nodes must have the same configured minimum election timeout,
 otherwise read-only transactions are not guaranteed to be completely up-to-date.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>timeout</code> - minimum election timeout in milliseconds</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/javase/7/docs/api/java/lang/IllegalStateException.html?is-external=true" title="class or interface in java.lang">IllegalStateException</a></code> - if this instance is already started</dd>
<dd><code><a href="https://docs.oracle.com/javase/7/docs/api/java/lang/IllegalArgumentException.html?is-external=true" title="class or interface in java.lang">IllegalArgumentException</a></code> - if <code>timeout &lt;= 0</code></dd></dl>
</li>
</ul>
<a name="setMaxElectionTimeout(int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setMaxElectionTimeout</h4>
<pre>public&nbsp;void&nbsp;<a href="../../../../src-html/org/jsimpledb/kv/raft/RaftKVDatabase.html#line.416">setMaxElectionTimeout</a>(int&nbsp;timeout)</pre>
<div class="block">Configure the maximum election timeout.

 <p>
 Default is <a href="../../../../org/jsimpledb/kv/raft/RaftKVDatabase.html#DEFAULT_MAX_ELECTION_TIMEOUT"><code>DEFAULT_MAX_ELECTION_TIMEOUT</code></a>.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>timeout</code> - maximum election timeout in milliseconds</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/javase/7/docs/api/java/lang/IllegalStateException.html?is-external=true" title="class or interface in java.lang">IllegalStateException</a></code> - if this instance is already started</dd>
<dd><code><a href="https://docs.oracle.com/javase/7/docs/api/java/lang/IllegalArgumentException.html?is-external=true" title="class or interface in java.lang">IllegalArgumentException</a></code> - if <code>timeout &lt;= 0</code></dd></dl>
</li>
</ul>
<a name="setHeartbeatTimeout(int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setHeartbeatTimeout</h4>
<pre>public&nbsp;void&nbsp;<a href="../../../../src-html/org/jsimpledb/kv/raft/RaftKVDatabase.html#line.435">setHeartbeatTimeout</a>(int&nbsp;timeout)</pre>
<div class="block">Configure the heartbeat timeout.

 <p>
 This must be set to a value less than the <a href="../../../../org/jsimpledb/kv/raft/RaftKVDatabase.html#setMinElectionTimeout(int)">minimum election timeout</a>.

 <p>
 Default is <a href="../../../../org/jsimpledb/kv/raft/RaftKVDatabase.html#DEFAULT_HEARTBEAT_TIMEOUT"><code>DEFAULT_HEARTBEAT_TIMEOUT</code></a>.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>timeout</code> - heartbeat timeout in milliseconds</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/javase/7/docs/api/java/lang/IllegalStateException.html?is-external=true" title="class or interface in java.lang">IllegalStateException</a></code> - if this instance is already started</dd>
<dd><code><a href="https://docs.oracle.com/javase/7/docs/api/java/lang/IllegalArgumentException.html?is-external=true" title="class or interface in java.lang">IllegalArgumentException</a></code> - if <code>timeout &lt;= 0</code></dd></dl>
</li>
</ul>
<a name="setMaxTransactionDuration(int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setMaxTransactionDuration</h4>
<pre>public&nbsp;void&nbsp;<a href="../../../../src-html/org/jsimpledb/kv/raft/RaftKVDatabase.html#line.458">setMaxTransactionDuration</a>(int&nbsp;duration)</pre>
<div class="block">Configure the maximum supported duration for outstanding transactions.

 <p>
 This value is the <i>T<sub>max</sub></i> value from the <a href="../../../../org/jsimpledb/kv/raft/RaftKVDatabase.html" title="class in org.jsimpledb.kv.raft">overview</a>.
 A larger value means more memory may be used.

 <p>
 This value may be changed while this instance is already running.

 <p>
 Default is <a href="../../../../org/jsimpledb/kv/raft/RaftKVDatabase.html#DEFAULT_MAX_TRANSACTION_DURATION"><code>DEFAULT_MAX_TRANSACTION_DURATION</code></a>.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>duration</code> - maximum supported duration for outstanding transactions in milliseconds</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/javase/7/docs/api/java/lang/IllegalArgumentException.html?is-external=true" title="class or interface in java.lang">IllegalArgumentException</a></code> - if <code>duration &lt;= 0</code></dd><dt><span class="strong">See Also:</span></dt><dd><a href="../../../../org/jsimpledb/kv/raft/RaftKVDatabase.html#setMaxAppliedLogMemory(long)"><code>setMaxAppliedLogMemory(long)</code></a></dd></dl>
</li>
</ul>
<a name="setMaxAppliedLogMemory(long)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setMaxAppliedLogMemory</h4>
<pre>public&nbsp;void&nbsp;<a href="../../../../src-html/org/jsimpledb/kv/raft/RaftKVDatabase.html#line.483">setMaxAppliedLogMemory</a>(long&nbsp;memory)</pre>
<div class="block">Configure the maximum allowed memory used for caching log entries that have already been applied to the state machine.

 <p>
 This value is the <i>M<sub>max</sub></i> value from the <a href="../../../../org/jsimpledb/kv/raft/RaftKVDatabase.html" title="class in org.jsimpledb.kv.raft">overview</a>.
 A higher value means transactions may be larger and/or stay open longer without causing a <a href="../../../../org/jsimpledb/kv/RetryTransactionException.html" title="class in org.jsimpledb.kv"><code>RetryTransactionException</code></a>.

 <p>
 This value is approximate, and only affects leaders; followers do not cache applied log entries.

 <p>
 This value may be changed while this instance is already running.

 <p>
 Default is <a href="../../../../org/jsimpledb/kv/raft/RaftKVDatabase.html#DEFAULT_MAX_APPLIED_LOG_MEMORY"><code>DEFAULT_MAX_APPLIED_LOG_MEMORY</code></a>.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>memory</code> - maximum allowed memory usage for cached applied log entries</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/javase/7/docs/api/java/lang/IllegalArgumentException.html?is-external=true" title="class or interface in java.lang">IllegalArgumentException</a></code> - if <code>memory &lt;= 0</code></dd><dt><span class="strong">See Also:</span></dt><dd><a href="../../../../org/jsimpledb/kv/raft/RaftKVDatabase.html#setMaxTransactionDuration(int)"><code>setMaxTransactionDuration(int)</code></a></dd></dl>
</li>
</ul>
<a name="setCommitTimeout(int)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>setCommitTimeout</h4>
<pre>public&nbsp;void&nbsp;<a href="../../../../src-html/org/jsimpledb/kv/raft/RaftKVDatabase.html#line.506">setCommitTimeout</a>(int&nbsp;timeout)</pre>
<div class="block">Configure the default transaction commit timeout.

 <p>
 This value determines how transactions will wait once <a href="../../../../org/jsimpledb/kv/raft/RaftKVTransaction.html#commit()"><code>commit()</code></a>
 is invoked for the commit to succeed. This can be overridden on a per-transaction basis via
 <a href="../../../../org/jsimpledb/kv/raft/RaftKVTransaction.html#setTimeout(long)"><code>RaftKVTransaction.setTimeout(long)</code></a>.

 <p>
 This value may be changed while this instance is already running.

 <p>
 Default is <a href="../../../../org/jsimpledb/kv/raft/RaftKVDatabase.html#DEFAULT_COMMIT_TIMEOUT"><code>DEFAULT_COMMIT_TIMEOUT</code></a>.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>timeout</code> - transaction commit timeout in milliseconds, or zero for unlimited</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/javase/7/docs/api/java/lang/IllegalArgumentException.html?is-external=true" title="class or interface in java.lang">IllegalArgumentException</a></code> - if <code>timeout</code> is negative</dd><dt><span class="strong">See Also:</span></dt><dd><a href="../../../../org/jsimpledb/kv/raft/RaftKVTransaction.html#setTimeout(long)"><code>RaftKVTransaction.setTimeout(long)</code></a></dd></dl>
</li>
</ul>
<a name="start()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>start</h4>
<pre><a href="https://docs.oracle.com/javase/7/docs/api/javax/annotation/PostConstruct.html?is-external=true" title="class or interface in javax.annotation">@PostConstruct</a>
public&nbsp;void&nbsp;<a href="../../../../src-html/org/jsimpledb/kv/raft/RaftKVDatabase.html#line.525">start</a>()
           throws <a href="https://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></pre>
<div class="block">Start this instance.

 <p>
 Does nothing if already started or in the process of shutting down.
 </p></div>
<dl><dt><span class="strong">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/javase/7/docs/api/java/lang/IllegalStateException.html?is-external=true" title="class or interface in java.lang">IllegalStateException</a></code> - if this instance is not properly configured</dd>
<dd><code><a href="https://docs.oracle.com/javase/7/docs/api/java/lang/IllegalArgumentException.html?is-external=true" title="class or interface in java.lang">IllegalArgumentException</a></code> - if persistent data is corrupted</dd>
<dd><code><a href="https://docs.oracle.com/javase/7/docs/api/java/io/IOException.html?is-external=true" title="class or interface in java.io">IOException</a></code> - if an I/O error occurs</dd></dl>
</li>
</ul>
<a name="stop()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>stop</h4>
<pre><a href="https://docs.oracle.com/javase/7/docs/api/javax/annotation/PreDestroy.html?is-external=true" title="class or interface in javax.annotation">@PreDestroy</a>
public&nbsp;void&nbsp;<a href="../../../../src-html/org/jsimpledb/kv/raft/RaftKVDatabase.html#line.665">stop</a>()</pre>
<div class="block">Stop this instance.

 <p>
 Does nothing if not <a href="../../../../org/jsimpledb/kv/raft/RaftKVDatabase.html#start()">started</a> or in the process of shutting down.
 </p></div>
</li>
</ul>
<a name="getClusterId()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getClusterId</h4>
<pre>public&nbsp;int&nbsp;<a href="../../../../src-html/org/jsimpledb/kv/raft/RaftKVDatabase.html#line.861">getClusterId</a>()</pre>
<div class="block">Retrieve the unique 32-bit ID for this node's cluster.

 <p>
 A value of zero indicates an unconfigured system. Usually the reverse true, though an unconfigured system
 can have a non-zero cluster ID in the rare case where an error occurred persisting the initial log entry.</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>unique cluster ID, or zero if this node is unconfigured</dd></dl>
</li>
</ul>
<a name="getCurrentConfig()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getCurrentConfig</h4>
<pre>public&nbsp;<a href="https://docs.oracle.com/javase/7/docs/api/java/util/Map.html?is-external=true" title="class or interface in java.util">Map</a>&lt;<a href="https://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>,<a href="https://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&gt;&nbsp;<a href="../../../../src-html/org/jsimpledb/kv/raft/RaftKVDatabase.html#line.877">getCurrentConfig</a>()</pre>
<div class="block">Retrieve the current cluster configuration as understood by this node.

 <p>
 Configuration changes are performed and committed in the context of a normal transaction; see
 <a href="../../../../org/jsimpledb/kv/raft/RaftKVTransaction.html#configChange"><code>RaftKVTransaction.configChange()</code></a>.

 <p>
 If this system is unconfigured, an emtyp map is returned (and vice-versa).</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>current configuration mapping from node identity to network address, or empty if this node is unconfigured</dd></dl>
</li>
</ul>
<a name="isConfigured()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>isConfigured</h4>
<pre>public&nbsp;boolean&nbsp;<a href="../../../../src-html/org/jsimpledb/kv/raft/RaftKVDatabase.html#line.890">isConfigured</a>()</pre>
<div class="block">Determine whether this instance is configured.

 <p>
 A node is configured iff it has added at least one Raft log entry (because the first log entry in any
 new cluster always includes a configuration change that adds the first node in the cluster).</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>true if this instance is configured, otherwise false</dd></dl>
</li>
</ul>
<a name="isClusterMember()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>isClusterMember</h4>
<pre>public&nbsp;boolean&nbsp;<a href="../../../../src-html/org/jsimpledb/kv/raft/RaftKVDatabase.html#line.899">isClusterMember</a>()</pre>
<div class="block">Determine whether this node thinks that it is part of the cluster, as currently configured on this node.</div>
<dl><dt><span class="strong">Returns:</span></dt><dd>true if this instance is part of the cluster, otherwise false</dd></dl>
</li>
</ul>
<a name="isClusterMember(java.lang.String)">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>isClusterMember</h4>
<pre>public&nbsp;boolean&nbsp;<a href="../../../../src-html/org/jsimpledb/kv/raft/RaftKVDatabase.html#line.909">isClusterMember</a>(<a href="https://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;node)</pre>
<div class="block">Determine whether this node thinks that the specified node is part of the cluster, as currently configured on this node.</div>
<dl><dt><span class="strong">Parameters:</span></dt><dd><code>node</code> - node identity</dd>
<dt><span class="strong">Returns:</span></dt><dd>true if the specified node is part of the cluster, otherwise false</dd></dl>
</li>
</ul>
<a name="createTransaction()">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>createTransaction</h4>
<pre>public&nbsp;<a href="../../../../org/jsimpledb/kv/raft/RaftKVTransaction.html" title="class in org.jsimpledb.kv.raft">RaftKVTransaction</a>&nbsp;<a href="../../../../src-html/org/jsimpledb/kv/raft/RaftKVDatabase.html#line.921">createTransaction</a>()</pre>
<div class="block">Create a new transaction.</div>
<dl>
<dt><strong>Specified by:</strong></dt>
<dd><code><a href="../../../../org/jsimpledb/kv/KVDatabase.html#createTransaction()">createTransaction</a></code>&nbsp;in interface&nbsp;<code><a href="../../../../org/jsimpledb/kv/KVDatabase.html" title="interface in org.jsimpledb.kv">KVDatabase</a></code></dd>
<dt><span class="strong">Returns:</span></dt><dd>newly created transaction</dd>
<dt><span class="strong">Throws:</span></dt>
<dd><code><a href="https://docs.oracle.com/javase/7/docs/api/java/lang/IllegalStateException.html?is-external=true" title="class or interface in java.lang">IllegalStateException</a></code> - if this instance is not <a href="../../../../org/jsimpledb/kv/raft/RaftKVDatabase.html#start()">started</a> or in the process of shutting down</dd></dl>
</li>
</ul>
<a name="toString()">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>toString</h4>
<pre>public&nbsp;<a href="https://docs.oracle.com/javase/7/docs/api/java/lang/String.html?is-external=true" title="class or interface in java.lang">String</a>&nbsp;<a href="../../../../src-html/org/jsimpledb/kv/raft/RaftKVDatabase.html#line.1672">toString</a>()</pre>
<dl>
<dt><strong>Overrides:</strong></dt>
<dd><code><a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true#toString()" title="class or interface in java.lang">toString</a></code>&nbsp;in class&nbsp;<code><a href="https://docs.oracle.com/javase/7/docs/api/java/lang/Object.html?is-external=true" title="class or interface in java.lang">Object</a></code></dd>
</dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar_bottom">
<!--   -->
</a><a href="#skip-navbar_bottom" title="Skip navigation links"></a><a name="navbar_bottom_firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/RaftKVDatabase.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-all.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li>Prev Class</li>
<li><a href="../../../../org/jsimpledb/kv/raft/RaftKVTransaction.html" title="class in org.jsimpledb.kv.raft"><span class="strong">Next Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?org/jsimpledb/kv/raft/RaftKVDatabase.html" target="_top">Frames</a></li>
<li><a href="RaftKVDatabase.html" target="_top">No Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../allclasses-noframe.html">All Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li><a href="#field_summary">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_summary">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li><a href="#field_detail">Field</a>&nbsp;|&nbsp;</li>
<li><a href="#constructor_detail">Constr</a>&nbsp;|&nbsp;</li>
<li><a href="#method_detail">Method</a></li>
</ul>
</div>
<a name="skip-navbar_bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
